console.log("ClipBook Background Service Started (클립북 백그라운드 서비스 시작)");chrome.runtime.onInstalled.addListener(()=>{console.log("ClipBook AI Extension installed (설치 완료)"),chrome.contextMenus.create({id:"save-clip",title:"ClipBook에 저장 (Save to ClipBook)",contexts:["selection"]})});chrome.contextMenus.onClicked.addListener((t,o)=>{if(t.menuItemId==="save-clip"&&t.selectionText){console.log("Saving selection (선택 내용 저장):",t.selectionText);const n={id:Date.now().toString(),text:t.selectionText,sourceUrl:(o==null?void 0:o.url)||"",timestamp:Date.now()};chrome.storage.local.get(["clippings"],i=>{const s=[...i.clippings||[],n];chrome.storage.local.set({clippings:s},()=>{console.log("Selection saved to storage (스토리지 저장 완료)")})})}});chrome.runtime.onMessage.addListener((t,o,n)=>{if(t.action==="SAVE_TO_NOTION"){const{token:i,databaseId:r,title:s,content:c,url:a}=t.data;return fetch("https://api.notion.com/v1/pages",{method:"POST",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json","Notion-Version":"2022-06-28"},body:JSON.stringify({parent:{database_id:r},properties:{title:{title:[{text:{content:s}}]},URL:{url:a}},children:[{object:"block",type:"paragraph",paragraph:{rich_text:[{type:"text",text:{content:c.substring(0,2e3)}}]}}]})}).then(e=>e.ok?e.json():e.json().then(l=>{throw new Error(l.message||e.statusText)})).then(e=>n({success:!0,data:e})).catch(e=>n({success:!1,error:e.message})),!0}});
