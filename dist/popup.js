import{r as d,j as e,I as h,S as k,d as xe,h as ge,E as pe,R as J,s as K,T as me,P as ue,g as he,a as fe}from"./storage.js";const be=({clippings:f,onAddClipping:D,onRemoveClipping:l,onStartAI:b,onCaptureFromPage:x,onCaptureImage:v,isProcessing:n,interference:y,onInterferenceChange:c})=>{const[g,j]=d.useState(""),[o,A]=d.useState(null),N=s=>{if(s.key==="Enter"&&s.ctrlKey){const w=s.currentTarget.value.trim();w&&(D(w),s.currentTarget.value="")}};return e.jsxs("div",{className:"flex flex-col gap-6 animate-in fade-in slide-in-from-bottom-4 duration-500 pb-20",children:[e.jsxs("section",{className:"premium-card p-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 mb-5",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h2",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-indigo-50 flex items-center justify-center text-indigo-600 shrink-0",children:e.jsx(h.Clip,{})}),e.jsx("span",{className:"bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent whitespace-nowrap",children:"í…ìŠ¤íŠ¸ ìˆ˜ì§‘"})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:x,className:"text-[11px] font-bold py-2.5 rounded-xl transition-all bg-indigo-50 text-indigo-600 hover:bg-indigo-100 hover:shadow-md active:scale-95 border border-indigo-100 flex items-center justify-center gap-1.5",children:[e.jsx("span",{children:"âœ¨"}),e.jsx("span",{children:"í…ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°"})]}),e.jsxs("button",{onClick:v,className:"text-[11px] font-bold py-2.5 rounded-xl transition-all bg-purple-50 text-purple-600 hover:bg-purple-100 hover:shadow-md active:scale-95 border border-purple-100 flex items-center justify-center gap-1.5",children:[e.jsx(h.Camera,{}),e.jsx("span",{children:"ì´ë¯¸ì§€ ìº¡ì²˜"})]})]})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("textarea",{id:"manual-input",placeholder:"ì—¬ê¸°ì— ì§ì ‘ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ê±°ë‚˜ Ctrl+Enterë¡œ ìˆ˜ì§‘í•˜ì„¸ìš”...",className:"w-full h-36 p-5 text-sm bg-gray-50/50 rounded-2xl border border-gray-100 focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all resize-none custom-scrollbar outline-none pb-12",onKeyDown:N}),e.jsx("div",{className:"absolute bottom-3 right-3",children:e.jsxs("button",{onClick:()=>{const s=document.getElementById("manual-input");s&&s.value.trim()&&(D(s.value.trim()),s.value="")},className:"group flex items-center justify-center bg-white/80 hover:bg-indigo-600 text-gray-400 hover:text-white border border-gray-100 hover:border-indigo-600 backdrop-blur-sm px-3 py-1.5 rounded-lg shadow-sm transition-all duration-300 min-w-[100px]",children:[e.jsxs("div",{className:"flex items-center gap-1 group-hover:hidden",children:[e.jsx("kbd",{className:"font-sans font-medium text-[10px] bg-gray-100 px-1.5 py-0.5 rounded border border-gray-200",children:"Ctrl"}),e.jsx("span",{className:"text-[10px]",children:"+"}),e.jsx("kbd",{className:"font-sans font-medium text-[10px] bg-gray-100 px-1.5 py-0.5 rounded border border-gray-200",children:"Enter"})]}),e.jsx("span",{className:"hidden group-hover:block text-xs font-bold animate-in fade-in zoom-in-95 duration-200",children:"ìˆ˜ì§‘"})]})})]}),f.length>0&&e.jsx("div",{className:"mt-5 flex flex-col gap-2 p-1",children:f.map(s=>e.jsxs("div",{className:"group relative bg-white border border-gray-200 text-gray-600 text-xs py-2 px-3 pr-8 rounded-lg shadow-sm hover:shadow-md hover:border-indigo-200 transition-all w-full animate-in zoom-in-95 duration-200 flex items-center gap-2",children:[s.type==="image"&&s.imageData?e.jsx("div",{className:"w-10 h-10 rounded border border-gray-100 overflow-hidden shrink-0 bg-gray-50 flex items-center justify-center",children:e.jsx("img",{src:s.imageData,alt:"Captured",className:"w-full h-full object-cover"})}):e.jsx("div",{className:"w-4 h-4 text-indigo-400 shrink-0",children:e.jsx(h.Clip,{})}),e.jsx("span",{className:"truncate opacity-80 flex-1",children:s.text}),e.jsx("button",{onClick:()=>l(s.id),className:"absolute right-1 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-all",children:"âœ•"})]},s.id))})]}),e.jsxs("section",{className:"premium-card p-6",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-800 mb-5 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-purple-50 flex items-center justify-center text-purple-600",children:"âš¡"}),"ì •ë¦¬ ë°©ì‹ ì„ íƒ"]}),e.jsx("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[{id:k.REPORT,label:"ë³´ê³ ì„œí˜•",icon:"ğŸ“„",desc:"ë¬¸ì„œ ìš”ì•½"},{id:k.EMAIL,label:"ë©”ì¼í˜•",icon:"âœ‰ï¸",desc:"ë©”ì¼ ì´ˆì•ˆ"},{id:k.NOTION,label:"ë…¸ì…˜ ë…¸íŠ¸",icon:"ğŸ“",desc:"êµ¬ì¡°í™” ì •ë¦¬"},{id:k.CARD,label:"ì¹´ë“œë‰´ìŠ¤",icon:"ğŸ“‡",desc:"í•µì‹¬ ìš”ì•½"}].map(s=>e.jsxs("button",{onClick:()=>A(s.id),className:`flex items-center gap-3 p-3 rounded-xl border transition-all duration-300 relative overflow-hidden group text-left ${o===s.id?"border-indigo-500 bg-indigo-50/50 shadow-md ring-1 ring-indigo-500/20":"border-gray-100 hover:border-indigo-200 hover:bg-gray-50 hover:shadow-sm"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center text-lg transition-colors shrink-0 ${o===s.id?"bg-white shadow-sm":"bg-gray-100 group-hover:bg-white"}`,children:s.icon}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`text-xs font-bold ${o===s.id?"text-indigo-700":"text-gray-700"}`,children:s.label}),e.jsx("span",{className:"text-[10px] text-gray-400 mt-0.5",children:s.desc})]}),o===s.id&&e.jsx("div",{className:"absolute top-2 right-2 w-1.5 h-1.5 rounded-full bg-indigo-500 animate-pulse"})]},s.id))}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Optional Instruction"}),e.jsx("input",{type:"text",value:g,onChange:s=>j(s.target.value),placeholder:"ì˜ˆ: 'íŒ€ ë‚´ ê³µìœ ìš©ìœ¼ë¡œ ë¶€ë“œëŸ¬ìš´ ë§íˆ¬ë¡œ ìš”ì•½í•´ì¤˜'",className:"w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all outline-none"})]}),e.jsxs("div",{className:"mb-8 p-4 bg-gray-50/50 border border-gray-100 rounded-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs font-bold text-gray-700",children:"AI ê°„ì„­ ì •ë„ (AI Interference)"}),e.jsx("span",{className:"text-[10px] text-gray-400 mt-0.5",children:y===0?"ì›ë¬¸ì— ë§¤ìš° ì¶©ì‹¤í•¨":y<=40?"ì •êµí•œ ìš”ì•½ ì¤‘ì‹¬":y<=70?"ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ì¥ ì¬êµ¬ì„±":"ì°½ì˜ì ì¸ í™•ì¥ ë° ë³€í˜•"})]}),e.jsxs("span",{className:`text-sm font-black ${y>70?"text-purple-600":"text-indigo-600"}`,children:[y,"%"]})]}),e.jsxs("div",{className:"relative flex items-center group",children:[e.jsx("input",{type:"range",min:"0",max:"100",step:"10",value:y,onChange:s=>c(parseInt(s.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-indigo-600 focus:outline-none transition-all"}),e.jsxs("div",{className:"absolute top-5 left-0 w-full flex justify-between px-0.5 pointer-events-none",children:[e.jsx("span",{className:"text-[8px] font-bold text-gray-400",children:"0%"}),e.jsx("span",{className:"text-[8px] font-bold text-gray-400",children:"50%"}),e.jsx("span",{className:"text-[8px] font-bold text-gray-400",children:"100%"})]})]})]}),e.jsxs("button",{disabled:!o||f.length===0||n,onClick:()=>o&&b(o,g),className:`w-full py-4 rounded-2xl font-bold text-base shadow-lg transition-all transform active:scale-[0.98] flex items-center justify-center gap-2 relative overflow-hidden group ${!o||f.length===0||n?"bg-gray-100 text-gray-400 cursor-not-allowed shadow-none border border-gray-200":"bg-gradient-to-r from-indigo-600 to-purple-600 text-white hover:shadow-indigo-500/30"}`,children:[n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{children:"AIê°€ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"ì •ë¦¬ ì‹œì‘í•˜ê¸°"}),e.jsx("span",{className:"opacity-70 group-hover:translate-x-1 transition-transform",children:"â†’"})]}),!n&&!(!o||f.length===0)&&e.jsx("div",{className:"absolute top-0 -inset-full h-full w-1/2 z-5 block transform -skew-x-12 bg-gradient-to-r from-transparent to-white opacity-20 group-hover:animate-shine"})]})]})]})},ye=({history:f,onDelete:D,onExport:l})=>{const[b,x]=d.useState(""),v=f.filter(n=>n.title.toLowerCase().includes(b.toLowerCase())||n.summary.toLowerCase().includes(b.toLowerCase()));return e.jsxs("div",{className:"flex flex-col gap-6 animate-in fade-in duration-500 pb-10",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"ì €ì¥ëœ ë©”ëª¨ ê²€ìƒ‰...",value:b,onChange:n=>x(n.target.value),className:"w-full pl-12 pr-4 py-4 bg-white rounded-2xl shadow-sm border border-gray-100 focus:ring-2 focus:ring-indigo-500 transition-all outline-none"}),e.jsx("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})})]}),e.jsx("div",{className:"flex flex-col gap-4",children:v.length>0?v.map(n=>{var y;return e.jsxs("div",{onClick:()=>{const c=document.getElementById(`summary-${n.id}`);c&&c.classList.toggle("line-clamp-2")},className:"premium-card p-5 cursor-pointer group hover:border-indigo-300 relative",children:[e.jsx("button",{onClick:c=>{c.stopPropagation(),D(n.id)},className:"absolute top-4 right-4 p-2 text-gray-300 hover:text-red-500 hover:bg-red-50 rounded-full transition-all opacity-0 group-hover:opacity-100",title:"ì‚­ì œ",children:"âœ•"}),e.jsxs("div",{className:"flex justify-between items-start mb-3 pr-8",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-[10px] font-bold tracking-wider text-indigo-600 uppercase px-2 py-1 bg-indigo-50 rounded-md border border-indigo-100",children:n.mode}),n.target&&e.jsxs("span",{className:"text-[10px] font-bold tracking-wider text-gray-600 uppercase px-2 py-1 bg-gray-50 rounded-md border border-gray-100",children:["via ",n.target]})]}),e.jsx("span",{className:"text-[10px] text-gray-400 font-medium",children:new Date(n.timestamp).toLocaleDateString()})]}),e.jsx("h3",{className:"font-bold text-gray-800 mb-2 text-base group-hover:text-indigo-600 transition-colors line-clamp-1",children:n.title}),e.jsxs("div",{className:"flex gap-4 mb-2",children:[n.clippings.find(c=>c.type==="image"&&c.imageData)&&e.jsx("div",{className:"w-20 h-20 rounded-xl overflow-hidden shrink-0 border border-gray-100 shadow-sm",children:e.jsx("img",{src:(y=n.clippings.find(c=>c.type==="image"))==null?void 0:y.imageData,alt:"Thumbnail",className:"w-full h-full object-cover"})}),e.jsx("p",{id:`summary-${n.id}`,className:"text-sm text-gray-600 line-clamp-3 leading-relaxed transition-all flex-1",children:n.summary})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-50 flex items-center justify-between text-[11px] text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1.5 font-medium",children:[e.jsx(h.Clip,{})," ",n.clippings.length," clips"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:c=>{var j;c.stopPropagation();const g=(j=n.clippings[0])==null?void 0:j.sourceUrl;g&&window.open(g,"_blank")},className:"px-3 py-1.5 bg-gray-50 rounded-lg text-gray-600 font-medium hover:bg-indigo-50 hover:text-indigo-600 transition-colors text-xs border border-gray-200 hover:border-indigo-200",children:"ì›ë¬¸ â†—"}),e.jsx("button",{onClick:c=>{c.stopPropagation(),l("NOTION",n)},className:"px-3 py-1.5 bg-white rounded-lg text-indigo-600 font-bold hover:bg-indigo-600 hover:text-white transition-all text-xs border border-indigo-200 shadow-sm",children:"Notion"}),e.jsx("button",{onClick:c=>{c.stopPropagation(),l("PDF",n)},className:"px-3 py-1.5 bg-white rounded-lg text-red-500 font-bold hover:bg-red-500 hover:text-white transition-all text-xs border border-red-200 shadow-sm",children:"PDF"})]})]})]},n.id)}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-400",children:[e.jsx("div",{className:"p-4 bg-gray-100 rounded-full mb-4",children:e.jsx(h.History,{})}),e.jsx("p",{className:"text-sm",children:"ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤."})]})})]})},V=async(f,D,l,b)=>{const x=document.createElement("div");x.id="pdf-render-container",x.style.position="fixed",x.style.left="-9999px",x.style.top="0",x.style.width="800px",x.style.backgroundColor="white",x.style.padding="60px",x.style.color="#1f2937",x.style.fontFamily="'Noto Sans KR', sans-serif",x.style.lineHeight="1.7";let v=D;const n=/\[IMAGE_ID:\s*(\d+)\]/g;v=v.replace(n,(g,j)=>{const o=b.find(A=>A.id===j);return o&&o.type==="image"&&o.imageData?`<div style="margin: 20px 0; text-align: center;">
                <img src="${o.imageData}" style="max-width: 100%; border-radius: 8px; border: 1px solid #eee;" />
                <p style="font-size: 8pt; color: #9ca3af; margin-top: 5px;">[ìˆ˜ì§‘ ì´ë¯¸ì§€: ${j}]</p>
              </div>`:g});const y=await xe.parse(v),c=g=>{switch(g){case k.REPORT:return"border-left: 10px solid #1e40af; padding-left: 30px;";case k.EMAIL:return"border: 1px solid #e5e7eb; border-radius: 12px; padding: 40px; box-shadow: 0 4px 6px rgba(0,0,0,0.05);";case k.CARD:return"background: linear-gradient(135deg, #4c1d95 0%, #1e1b4b 100%); color: white; padding: 80px; border-radius: 20px; text-align: center;";default:return""}};x.innerHTML=`
    <div style="font-family: sans-serif; ${c(l)}">
      <div style="border-bottom: 2px solid #4f46e5; padding-bottom: 20px; margin-bottom: 30px;">
        <h1 style="font-size: 24pt; margin: 0; color: ${l===k.CARD?"#fff":"#111"};">${f}</h1>
        <p style="font-size: 10pt; color: ${l===k.CARD?"rgba(255,255,255,0.7)":"#6b7280"}; margin-top: 10px;">
          ClipBook AI Researcher Report | ${l} Edition | ${new Date().toLocaleDateString()}
        </p>
      </div>
      <div class="markdown-content" style="font-size: 11pt; color: ${l===k.CARD?"#fff":"#374151"};">
        ${y}
      </div>
      <div style="margin-top: 50px; border-top: 1px solid #eee; padding-top: 20px; font-size: 9pt; color: #9ca3af; text-align: center;">
        Generated by ClipBook AI &copy; ${new Date().getFullYear()}
      </div>
    </div>
    <style>
      .markdown-content h2 { font-size: 18pt; margin-top: 1.5em; border-bottom: 1px solid #eee; padding-bottom: 5px; color: ${l===k.CARD?"#f472b6":"#4b5563"}; }
      .markdown-content p { margin-bottom: 1em; text-align: justify; }
      .markdown-content ul, .markdown-content ol { margin-bottom: 1em; padding-left: 20px; }
      .markdown-content li { margin-bottom: 5px; }
      .markdown-content blockquote { border-left: 4px solid #4f46e5; background: #f9fafb; padding: 10px 20px; margin: 1.5em 0; font-style: italic; color: #4b5563; }
      .markdown-content strong { color: #4f46e5; }
    </style>
  `,document.body.appendChild(x);try{const j=(await ge(x,{scale:2,useCORS:!0,logging:!1,backgroundColor:l===k.CARD?"#1e1b4b":"#ffffff"})).toDataURL("image/png"),o=new pe({orientation:"p",unit:"mm",format:"a4"}),A=o.getImageProperties(j),N=o.internal.pageSize.getWidth(),s=A.height*N/A.width;let w=s,P=0;const O=o.internal.pageSize.getHeight();for(o.addImage(j,"PNG",0,P,N,s),w-=O;w>=0;)P=w-s,o.addPage(),o.addImage(j,"PNG",0,P,N,s),w-=O;const C=o.output("datauristring").split(",")[1],R=`${f.replace(/[/\\?%*:|"<>]/g,"").trim()||"ClipBook_Report"}.pdf`;chrome.runtime.sendMessage({action:"DOWNLOAD_FILE",data:{base64:C,filename:R}},I=>{(chrome.runtime.lastError||I&&!I.success)&&console.error("Download message failed:",chrome.runtime.lastError||(I==null?void 0:I.error))})}catch(g){throw console.error("PDF Generation Error:",g),new Error("PDF ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{const g=document.getElementById("pdf-render-container");g&&document.body.removeChild(g)}},je=()=>{const[f,D]=d.useState("capture"),[l,b]=d.useState([]),[x,v]=d.useState([]),n=J.useRef(!1),[y,c]=d.useState(""),[g,j]=d.useState(""),[o,A]=d.useState(""),[N,s]=d.useState(""),[w,P]=d.useState(""),[O,$]=d.useState(!0),[C,F]=d.useState("gemini-3-flash-preview"),[R,I]=d.useState(!1),[E,W]=d.useState(!1),[T,M]=d.useState(null),[H,X]=d.useState(50),[G,U]=d.useState(null),[L,Z]=d.useState(!1),[B,ee]=d.useState(!1),[_,te]=d.useState(!1),[z,se]=d.useState(!1),p=(r,i="info")=>{U({message:r,type:i})};d.useEffect(()=>{(async()=>{const t=["history","clippings","apiKey","openaiApiKey","claudeApiKey","notionToken","notionDbId","showFloatingButton","aiModel"],a=await K.get(t);a.history&&v(a.history),a.clippings&&b(a.clippings),a.apiKey&&c(a.apiKey),a.openaiApiKey&&j(a.openaiApiKey),a.claudeApiKey&&A(a.claudeApiKey),a.notionToken&&s(a.notionToken),a.notionDbId&&P(a.notionDbId),a.showFloatingButton!==void 0&&$(a.showFloatingButton);let u=a.aiModel||"gemini-3-flash-preview";const m=["gemini-1.5-flash","gemini-1.5-flash-001","gemini-1.5-flash-latest","gemini-2.0-flash","gemini-2.0-flash-lite-preview-02-05","gemini-2.0-flash-lite","gemini-1.0-pro"],S=["gemini-1.5-pro-001","gemini-pro","gemini-1.5-pro-002","gemini-1.5-pro","gemini-2.0-pro-exp"];(m.includes(u)||S.includes(u))&&(S.includes(u)?u="gemini-3-pro-preview":u="gemini-3-flash-preview",K.set({aiModel:u})),console.log(`[Storage] Loaded AI Model: ${u}`),F(u),n.current=!0})();const i=K.onChange(t=>{t.history!==void 0&&v(t.history),t.clippings!==void 0&&b(t.clippings),t.apiKey!==void 0&&c(t.apiKey),t.openaiApiKey!==void 0&&j(t.openaiApiKey),t.claudeApiKey!==void 0&&A(t.claudeApiKey),t.notionToken!==void 0&&s(t.notionToken),t.notionDbId!==void 0&&P(t.notionDbId),t.showFloatingButton!==void 0&&$(t.showFloatingButton==="true"||t.showFloatingButton===!0),t.aiModel!==void 0&&F(t.aiModel)});return()=>i()},[]),d.useEffect(()=>{n.current&&K.set({history:x})},[x]);const re=r=>{window.confirm("ì •ë§ë¡œ ì´ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&(v(i=>i.filter(t=>t.id!==r)),p("ê¸°ë¡ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.","info"))},ie=async()=>{await K.set({apiKey:y,openaiApiKey:g,claudeApiKey:o,notionToken:N,notionDbId:w,showFloatingButton:O,aiModel:C}),I(!1),p("ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.","success")},q=(r,i="text",t)=>{const a={id:Date.now().toString(),type:i,text:r,imageData:t,sourceUrl:window.location.href,timestamp:Date.now()},u=[...l,a];b(u),K.set({clippings:u}),p(i==="image"?"ì´ë¯¸ì§€ê°€ ìˆ˜ì§‘ë˜ì—ˆìŠµë‹ˆë‹¤.":"í…ìŠ¤íŠ¸ê°€ ìˆ˜ì§‘ë˜ì—ˆìŠµë‹ˆë‹¤.","success")},ae=r=>{const i=l.filter(t=>t.id!==r);b(i),K.set({clippings:i})},ne=async(r,i)=>{if(l.length===0)return;const t=C.startsWith("gemini"),a=C.startsWith("gpt"),u=C.startsWith("claude");let m="";if(t&&(m=y||"PLACEHOLDER_API_KEY"),a&&(m=g),u&&(m=o),!m){p(`${t?"Gemini":a?"OpenAI":"Anthropic"} API Keyê°€ í•„ìš”í•©ë‹ˆë‹¤. ì„¤ì •(âš™ï¸)ì—ì„œ ì…ë ¥í•´ì£¼ì„¸ìš”.`,"error"),I(!0);return}W(!0);try{const S=await he(r,l,i,m,C,H);M({mode:r,content:S})}catch(S){const Y=S instanceof Error?S.message:"AI ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";p(Y,"error")}finally{W(!1)}},oe=()=>{chrome.tabs.query({active:!0,currentWindow:!0},r=>{const i=r[0];i!=null&&i.id&&chrome.tabs.sendMessage(i.id,{action:"GET_SELECTION"},t=>{if(chrome.runtime.lastError){p("í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ê±°ë‚˜ í…ìŠ¤íŠ¸ë¥¼ ì„ íƒí•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.","error");return}t&&t.text?q(t.text):p("ì„ íƒëœ í…ìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.","info")})})},le=()=>{chrome.tabs.query({active:!0,currentWindow:!0},r=>{const i=r[0];i!=null&&i.id&&chrome.tabs.sendMessage(i.id,{action:"START_REGION_CAPTURE"},t=>{if(chrome.runtime.lastError){p("í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.","error");return}t&&t.success&&window.close()})})},de=async(r,i,t)=>{var u;if(!T)return;const a={id:Date.now().toString(),title:t,summary:i,clippings:[...l],mode:T.mode,target:r,timestamp:Date.now(),collection:"ì „ì²´"};try{if(r==="PDF")V(t,i,T.mode,[...l]),p("PDF íŒŒì¼ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.","success");else if(r==="NOTION"){if(!N||!w){p("Notion ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤. ì„¤ì • ë©”ë‰´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.","error"),I(!0);return}chrome.runtime.sendMessage({action:"SAVE_TO_NOTION",data:{token:N,databaseId:w,title:t,content:i,url:((u=l[0])==null?void 0:u.sourceUrl)||"",mode:T.mode,clippings:[...l]}},m=>{m&&m.success?(p("ë…¸ì…˜ í˜ì´ì§€ì— ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!","success"),v(S=>[a,...S]),b([]),M(null)):p("ë…¸ì…˜ ì €ì¥ ì‹¤íŒ¨: "+((m==null?void 0:m.error)||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"),"error")});return}else r==="HISTORY"&&p("ê¸°ë¡ë³´ê´€í•¨ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.","success");v(m=>[a,...m]),b([]),M(null)}catch(m){console.error(m),p("ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.","error")}},ce=async(r,i)=>{var t;try{if(r==="PDF")V(i.title,i.summary,i.mode,i.clippings),p("PDF íŒŒì¼ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.","success");else if(r==="NOTION"){if(!N||!w){p("Notion ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.","error"),I(!0);return}chrome.runtime.sendMessage({action:"SAVE_TO_NOTION",data:{token:N,databaseId:w,title:i.title,content:i.summary,url:((t=i.clippings[0])==null?void 0:t.sourceUrl)||"",mode:i.mode}},a=>{a&&a.success?p("ë…¸ì…˜ í˜ì´ì§€ì— ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!","success"):p("ë…¸ì…˜ ì €ì¥ ì‹¤íŒ¨: "+((a==null?void 0:a.error)||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"),"error")})}}catch(a){console.error(a),p("ë‚´ë³´ë‚´ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.","error")}};return e.jsxs("div",{className:"h-full bg-[#f8f9fa] text-[#212529] flex flex-col overflow-hidden relative",children:[e.jsxs("div",{className:"fixed top-0 left-0 w-full h-full overflow-hidden pointer-events-none z-0",children:[e.jsx("div",{className:"absolute -top-[10%] -right-[10%] w-[80%] h-[80%] bg-indigo-200/20 blur-[100px] rounded-full mix-blend-multiply"}),e.jsx("div",{className:"absolute -bottom-[10%] -left-[10%] w-[80%] h-[80%] bg-purple-200/20 blur-[100px] rounded-full mix-blend-multiply"})]}),G&&e.jsx(me,{message:G.message,type:G.type,onClose:()=>U(null)}),e.jsxs("header",{className:`sticky top-0 z-40 glass-morphism px-6 py-4 flex items-center justify-between transition-all duration-300 ${E?"pointer-events-none opacity-50":""}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl flex items-center justify-center text-white shadow-lg shadow-indigo-200 transform hover:scale-105 transition-transform duration-300",children:e.jsx(h.Clip,{})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{className:"text-lg font-extrabold tracking-tight bg-gradient-to-r from-gray-900 to-gray-600 bg-clip-text text-transparent",children:"ClipBook AI"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("p",{className:"text-[10px] text-gray-500 font-medium tracking-wide",children:"Smart Researcher v1.0"})})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>!E&&I(!R),disabled:E,className:`p-2.5 rounded-xl transition-all duration-300 flex items-center justify-center ${R?"bg-indigo-50 text-indigo-600 rotate-180 shadow-inner":"text-gray-400 hover:bg-white hover:text-gray-600 hover:shadow-sm"}`,title:"ì„¤ì •",children:e.jsx(h.Settings,{})}),e.jsxs("nav",{className:"flex bg-gray-100/50 p-1 rounded-xl backdrop-blur-sm",children:[e.jsx("button",{onClick:()=>!E&&D("capture"),disabled:E,className:`px-5 py-2 rounded-lg text-xs font-bold transition-all duration-300 ${f==="capture"?"bg-white text-indigo-600 shadow-sm scale-100":"text-gray-400 hover:text-gray-600 scale-95"}`,children:"ìˆ˜ì§‘"}),e.jsx("button",{onClick:()=>!E&&D("history"),disabled:E,className:`px-5 py-2 rounded-lg text-xs font-bold transition-all duration-300 ${f==="history"?"bg-white text-indigo-600 shadow-sm scale-100":"text-gray-400 hover:text-gray-600 scale-95"}`,children:"ê¸°ë¡"})]})]})]}),E&&e.jsxs("div",{className:"fixed inset-0 z-[100] flex flex-col items-center justify-center glass-morphism animate-in fade-in duration-500",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsx("div",{className:"absolute inset-0 bg-indigo-500 rounded-full blur-[40px] opacity-20 animate-pulse-glow"}),e.jsx("div",{className:"w-24 h-24 border-4 border-indigo-100 rounded-full"}),e.jsx("div",{className:"absolute top-0 left-0 w-24 h-24 border-t-4 border-indigo-600 rounded-full animate-spin"}),e.jsx("div",{className:"absolute top-2 left-2 w-20 h-20 border-b-4 border-purple-500 rounded-full animate-spin-slow opacity-60"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-indigo-600 scale-125 animate-float",children:e.jsx(h.Clip,{})})]}),e.jsxs("div",{className:"text-center space-y-3 px-10",children:[e.jsx("h3",{className:"text-xl font-black text-gray-900 tracking-tight animate-in slide-in-from-bottom-2 duration-500",children:"AI ë¶„ì„ ì§„í–‰ ì¤‘..."}),e.jsxs("p",{className:"text-sm text-gray-500 font-medium leading-relaxed",children:["ìµœì²¨ë‹¨ Gemini 3.0 ëª¨ë¸ì´ ìˆ˜ì§‘ëœ í…ìŠ¤íŠ¸ë¥¼",e.jsx("br",{}),e.jsx("span",{className:"text-indigo-600 font-bold",children:"ê¹Šì´ ìˆê²Œ ë¶„ì„í•˜ê³  êµ¬ì¡°í™”"}),"í•˜ê³  ìˆìŠµë‹ˆë‹¤."]})]}),e.jsx("div",{className:"mt-12 w-48 h-1.5 bg-gray-100 rounded-full overflow-hidden shadow-inner",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 via-purple-500 to-indigo-500 w-full rounded-full animate-shimmer scale-x-[0.6] origin-left"})})]}),R&&e.jsxs("div",{className:"bg-white border-b border-gray-100 px-6 py-4 animate-in slide-in-from-top-2 max-h-[480px] overflow-y-auto custom-scrollbar shadow-inner",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"AI ëª¨ë¸ ì„ íƒ"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:C,onChange:r=>F(r.target.value),className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm appearance-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all cursor-pointer",children:[e.jsxs("optgroup",{label:"Google Gemini (3.0 Preview)",children:[e.jsx("option",{value:"gemini-3-flash-preview",children:"Gemini 3.0 Flash (ìµœì‹  í”„ë¦¬ë·°)"}),e.jsx("option",{value:"gemini-3-pro-preview",children:"Gemini 3.0 Pro (ìµœì‹  í”„ë¦¬ë·°)"})]}),e.jsxs("optgroup",{label:"OpenAI (GPT)",children:[e.jsx("option",{value:"gpt-4o",children:"GPT-4o (Omni)"}),e.jsx("option",{value:"gpt-4-turbo",children:"GPT-4 Turbo"})]}),e.jsx("optgroup",{label:"Anthropic (Claude)",children:e.jsx("option",{value:"claude-3-5-sonnet",children:"Claude 3.5 Sonnet"})})]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:e.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})]}),C.startsWith("gemini")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"Gemini API í‚¤"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:L?"text":"password",placeholder:"Gemini API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”",className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm pr-10",value:y,onChange:r=>c(r.target.value)}),e.jsx("button",{onClick:()=>Z(!L),className:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-400 hover:text-gray-600",tabIndex:-1,children:L?e.jsx(h.Eye,{}):e.jsx(h.EyeOff,{})})]})]}),C.startsWith("gpt")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"OpenAI API í‚¤"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:B?"text":"password",placeholder:"sk-...",className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm pr-10",value:g,onChange:r=>j(r.target.value)}),e.jsx("button",{onClick:()=>ee(!B),className:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-400 hover:text-gray-600",tabIndex:-1,children:B?e.jsx(h.Eye,{}):e.jsx(h.EyeOff,{})})]})]}),C.startsWith("claude")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"Anthropic API í‚¤"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:_?"text":"password",placeholder:"sk-ant-...",className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm pr-10",value:o,onChange:r=>A(r.target.value)}),e.jsx("button",{onClick:()=>te(!_),className:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-400 hover:text-gray-600",tabIndex:-1,children:_?e.jsx(h.Eye,{}):e.jsx(h.EyeOff,{})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"Notion í†µí•© í† í°"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:z?"text":"password",placeholder:"secret_... (Notion í† í°)",className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm pr-10",value:N,onChange:r=>s(r.target.value)}),e.jsx("button",{onClick:()=>se(!z),className:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-400 hover:text-gray-600",tabIndex:-1,children:z?e.jsx(h.Eye,{}):e.jsx(h.EyeOff,{})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"Notion ë°ì´í„°ë² ì´ìŠ¤ ID"}),e.jsx("input",{type:"text",placeholder:"ë°ì´í„°ë² ì´ìŠ¤ IDë¥¼ ì…ë ¥í•˜ì„¸ìš”",className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm",value:w,onChange:r=>P(r.target.value)})]}),e.jsx("div",{className:"mt-4 p-4 bg-indigo-50/50 border border-indigo-100/50 rounded-2xl transition-all hover:bg-indigo-50/80 group",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:"text-[13px] font-extrabold text-slate-800 tracking-tight",children:"í…ìŠ¤íŠ¸ ì„ íƒ ì‹œ ì €ì¥ ë²„íŠ¼ í‘œì‹œ"}),e.jsxs("p",{className:"text-[11px] text-slate-500 font-medium leading-relaxed",children:["ì›¹í˜ì´ì§€ì—ì„œ í…ìŠ¤íŠ¸ë¥¼ ë“œë˜ê·¸í•  ë•Œ ",e.jsx("br",{}),e.jsx("span",{className:"text-indigo-600 font-bold decoration-indigo-200 decoration-2 underline-offset-2",children:"ClipBook ì €ì¥ ë²„íŠ¼"}),"ì„ í‘œì‹œí•©ë‹ˆë‹¤."]})]}),e.jsx("button",{onClick:()=>$(!O),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-all duration-300 focus:outline-none focus:ring-4 focus:ring-indigo-500/20 ${O?"bg-indigo-600 shadow-lg shadow-indigo-200":"bg-slate-200"}`,children:e.jsx("span",{className:`${O?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform duration-300 ease-in-out`})})]})}),e.jsx("button",{onClick:ie,className:"w-full mt-2 px-4 py-2 bg-indigo-600 text-white text-xs font-bold rounded-lg hover:bg-indigo-700",children:"ì„¤ì • ì €ì¥"})]}),e.jsx("hr",{className:"my-4 border-gray-100"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-900 flex items-center gap-1",children:e.jsx("span",{children:"ğŸ’¡ ë„ì›€ë§"})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-indigo-500 mt-0.5",children:"â‘ "}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] font-bold text-gray-700",children:"Gemini API í‚¤ ë°œê¸‰"}),e.jsx("p",{className:"text-[10px] text-gray-500 leading-snug",children:"Google AI Studioì—ì„œ ë¬´ë£Œë¡œ ë°œê¸‰ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤."}),e.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noreferrer",className:"text-[10px] text-indigo-600 underline hover:text-indigo-800",children:"API í‚¤ ë°œê¸‰ë°›ê¸° â†’"})]})]}),e.jsxs("div",{className:"flex items-start gap-2 border-t border-gray-200 pt-2",children:[e.jsx("span",{className:"text-green-500 mt-0.5",children:"Op"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] font-bold text-gray-700",children:"OpenAI API í‚¤ ë°œê¸‰"}),e.jsx("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noreferrer",className:"text-[10px] text-indigo-600 underline hover:text-indigo-800",children:"OpenAI í‚¤ ë°œê¸‰ â†’"})]})]}),e.jsxs("div",{className:"flex items-start gap-2 border-t border-gray-200 pt-2",children:[e.jsx("span",{className:"text-orange-500 mt-0.5",children:"An"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] font-bold text-gray-700",children:"Anthropic API í‚¤ ë°œê¸‰"}),e.jsx("a",{href:"https://console.anthropic.com/settings/keys",target:"_blank",rel:"noreferrer",className:"text-[10px] text-indigo-600 underline hover:text-indigo-800",children:"Anthropic í‚¤ ë°œê¸‰ â†’"})]})]}),e.jsxs("div",{className:"flex items-start gap-2 border-t border-gray-200 pt-2",children:[e.jsx("span",{className:"text-indigo-500 mt-0.5",children:"â‘¡"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] font-bold text-gray-700",children:"Notion ì—°ë™"}),e.jsx("p",{className:"text-[10px] text-gray-500 leading-snug",children:"ìƒˆ í†µí•©ì„ ë§Œë“¤ê³  í† í°ê³¼ ë°ì´í„°ë² ì´ìŠ¤ IDë¥¼ ì…ë ¥í•˜ì„¸ìš”."}),e.jsx("a",{href:"https://developers.notion.com/docs/create-a-notion-integration",target:"_blank",rel:"noreferrer",className:"text-[10px] text-indigo-600 underline hover:text-indigo-800",children:"Notion í†µí•© ê°€ì´ë“œ â†’"})]})]}),e.jsxs("div",{className:"flex items-start gap-2 border-t border-gray-200 pt-2",children:[e.jsx("span",{className:"text-indigo-500 mt-0.5",children:"â‘¢"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] font-bold text-gray-700",children:"ë‹¨ì¶•í‚¤ ì•ˆë‚´"}),e.jsxs("p",{className:"text-[10px] text-gray-500 leading-snug",children:[e.jsx("span",{className:"inline-block bg-white border border-gray-200 rounded px-1",children:"Ctrl"}),"+",e.jsx("span",{className:"inline-block bg-white border border-gray-200 rounded px-1",children:"Enter"})," : í…ìŠ¤íŠ¸ ì¦‰ì‹œ ìˆ˜ì§‘",e.jsx("br",{})]})]})]})]})]})]}),e.jsx("main",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 relative z-10 space-y-6",children:f==="capture"?e.jsx(be,{clippings:l,onAddClipping:r=>q(r),onRemoveClipping:ae,onStartAI:ne,onCaptureFromPage:oe,onCaptureImage:le,isProcessing:E,interference:H,onInterferenceChange:X}):e.jsx(ye,{history:x,onDelete:re,onExport:ce})}),l.length>0&&f==="capture"&&e.jsxs("div",{className:"fixed bottom-8 left-1/2 -translate-x-1/2 bg-indigo-900 text-white px-6 py-3 rounded-full shadow-2xl flex items-center gap-4 animate-in slide-in-from-bottom-10 z-50",children:[e.jsxs("span",{className:"text-xs font-bold",children:[l.length,"ê°œì˜ ë¬¸ì¥ ì„ íƒë¨"]}),e.jsx("div",{className:"h-4 w-[1px] bg-white/20"}),e.jsx("button",{onClick:()=>b([]),className:"text-xs font-medium text-indigo-200 hover:text-white transition-colors",children:"ì´ˆê¸°í™”"})]}),T&&e.jsx(ue,{mode:T.mode,content:T.content,clippings:l,onClose:()=>M(null),onSave:de})]})},Q=document.getElementById("root");if(!Q)throw new Error("Could not find root element to mount to");const ve=fe.createRoot(Q);ve.render(e.jsx(J.StrictMode,{children:e.jsx(je,{})}));
